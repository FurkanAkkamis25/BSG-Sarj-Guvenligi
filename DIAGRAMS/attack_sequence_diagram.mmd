sequenceDiagram
    autonumber
    actor Attacker as ðŸ”´ SaldÄ±rgan (Attacker)
    participant EVSE as âš¡ Åžarj Ä°stasyonu (EVSE)
    participant Relay as ðŸ”Œ Fiziksel RÃ¶le (Hardware)
    participant CSMS as â˜ï¸ Merkezi YÃ¶netim (Server)
    participant Aegis as ðŸ›¡ï¸ Aegis AI / Koruma

    Note over Attacker, EVSE: SaldÄ±rgan "Oturum AÃ§Ä±k" durumundadÄ±r.
    
    loop Oscillating Attack Cycle (Frequency: 10Hz)
        Attacker->>EVSE: 1. StartTransaction (HÄ±zlÄ± Ä°stek)
        activate EVSE
        EVSE->>Relay: 2. Close Circuit (Energize)
        activate Relay
        Note right of Relay: âš ï¸ KontaktÃ¶r KapandÄ± (Ark OluÅŸumu)
        Relay-->>EVSE: Ack
        EVSE-->>Attacker: Status: Charging
        
        par Async Logging (Gecikmeli)
            EVSE->>CSMS: 3. StartTransaction Notification
        and Attack Continues
            Attacker->>EVSE: 4. StopTransaction (Hemen ardÄ±ndan)
        end
        
        EVSE->>Relay: 5. Open Circuit (De-energize)
        deactivate Relay
        Note right of Relay: ðŸŒ¡ï¸ ISI ARTIÅžI (Heat Spike +5Â°C)
        Relay-->>EVSE: Ack
        EVSE-->>Attacker: Status: Suspended
        deactivate EVSE
        
        Note over Relay: Mekanik Ã¶mÃ¼r tÃ¼keniyor...
    end

    Note over EVSE, Relay: !!! KRÄ°TÄ°K ISI EÅžÄ°ÄžÄ° AÅžILDI (80Â°C) !!!

    rect rgb(255, 230, 230)
        Note over EVSE, Aegis: Savunma MekanizmasÄ± Devreye Giriyor
        EVSE->>Aegis: Anomali Tespiti (Rapid Switching)
        Aegis->>EVSE: ðŸ›‘ ACÄ°L DURDURMA (Hard Lock)
        EVSE->>Relay: Force Open (GÃ¼venli Mod)
        EVSE->>Attacker: Error: "Blocked due to suspicious activity"
        EVSE->>CSMS: Security Alert: DoS Attack Detected
    end
